<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Intro - Aperture</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Intro";
        var mkdocs_page_input_path = "0-intro.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Aperture
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Intro</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#downloading-aperture">Downloading Aperture</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#development-in-a-container">Development in a Container</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#development-on-a-host-machine">Development on a Host Machine</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compiling-the-code">Compiling the Code</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#running-simulations">Running Simulations</a>
    </li>
    </ul>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../1-setup/">Quick Setup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../2-framework/">Framework</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../3-units/">Units</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutorials</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../4-two-stream/">Two stream instability</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../about/">About</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Aperture</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Intro</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="introduction">Introduction</h1>
<p>The name <code>Aperture</code> is a recursive acronym that stands for: "<strong>A</strong>perture is a code
for <strong>P</strong>articles, <strong>E</strong>lectrodynamics, and <strong>R</strong>adiative <strong>T</strong>ransfer at <strong>U</strong>ltra-<strong>R</strong>elativistic
<strong>E</strong>nergies". As the name suggests, its main goal is to simulation the interaction
of ultra-relativistic particles with electromagnetic field and radiation, which
occurs very often in astrophysical scenarios.</p>
<h2 id="downloading-aperture">Downloading Aperture</h2>
<p>To download and compile <code>Aperture</code>, you can clone it from the github repo:</p>
<pre><code>   $ git clone https://github.com/fizban007/Aperture4.git
</code></pre>
<h2 id="development-in-a-container">Development in a Container</h2>
<p>The easiest way to compile and develop <code>Aperture</code> is to use a Docker container.
The official development container is <code>fizban007/aperture_dev</code>. The image is
generated using the <code>develop.Dockerfile</code> under the main <code>Aperture</code> git repo. It
contains all the necessary libraries to develop <code>Aperture</code>.</p>
<p>In order to avoid using the root user in the container, a default user called
<code>developer</code> is created by default. It is recommended to mount a Docker volume
(or a host directory) to the root directory <code>/code</code> which is writable by user <code>developer</code>. One can do this using:</p>
<pre><code>   $ docker pull fizban007/aperture_dev
   $ docker volume create vol1
   $ docker run -it --name Aperture_dev --mount source=vol1,target=/code fizban007/aperture_dev
</code></pre>
<p>This will create a container named <code>Aperture_dev</code> which mounts the volume at the
correct location. Once in the container, one can clone the main code repo, use
VS Code to attach to the container and carry out development and debugging
there.</p>
<h2 id="development-on-a-host-machine">Development on a Host Machine</h2>
<p>To compile <code>Aperture</code> from scratch, you will need to have several libraries ready:</p>
<ul>
<li>
<p>A modern C++ compiler that supports <code>c++17</code>, e.g.: <code>gcc&gt;=7.0</code> or <code>clang&gt;=3.9</code> or <code>intel&gt;=19.0</code></p>
</li>
<li>
<p>An MPI implementation, e.g. <code>openmpi</code>, <code>intel-mpi</code>, <code>mpich</code>, etc.</p>
</li>
<li>An <code>hdf5</code> library, preferably an <code>mpi</code>-enabled version</li>
<li>The C++ library <code>boost&gt;=1.54</code></li>
<li>(Optional) The Cuda toolkit <code>cuda&gt;=11</code> that supports at least <code>c++17</code></li>
<li>(Optional) The ROCm toolkit provided by AMD</li>
</ul>
<p>To help with this, a bunch of configuration scripts under the <code>machines</code>
directory should contain the necessary <code>module load</code> for the given machine to
compile the code.</p>
<h2 id="compiling-the-code">Compiling the Code</h2>
<p>Whether you use a Docker container or manage the libraries on your own, you can compile the code using the following:</p>
<pre><code>   $ mkdir build &amp; cd build
   $ cmake ..
   $ make -j8
</code></pre>
<p>This will compile the main <code>Aperture</code> library, the test cases, and the problems.
The binary files for specific setups will be generated inside the corresponding
<code>problems/XXX/bin</code> directory.</p>
<p>The following are the options (and their default values) to <code>cmake</code> which
controls some compile-time configurations:</p>
<ul>
<li><code>-Duse_cuda=0</code>: If this option is 1, include the GPU part of <code>Aperture</code> and compile it as CUDA code.</li>
<li><code>-Duse_hip=0</code>: If this option is 1, include the GPU part of <code>Aperture</code> and
  compile it as the AMD HIP code. Note that one can specify both of these two
  options. In that case, it will try to compile the code through the HIP but
  using its CUDA implementation.</li>
<li><code>-Dbuild_tests=1</code>: If this option is 1, build the unit test suite.</li>
<li><code>-Duse_double=0</code>: If this option is 1, use double precision for all floating
  point calculations.</li>
<li><code>-Dlib_only=0</code>: If this option is 1, only build the <code>Aperture</code> library, but
  not any simulation setups in the <code>problems</code> directory.</li>
<li><code>-Duse_libcpp=0</code>: This option is specifically for the situation where you want
  to compile the code with <code>clang</code> and link to <code>libc++</code> instead of <code>libstdc++</code>.
  Generally keep it off unless you know what you are doing. Even then, it is not
  guaranteed to work.</li>
</ul>
<p>Apart from these options, standard CMake options apply as well. For example, the
code will compile in <code>Release</code> mode by default. To change it to <code>Debug</code>, append
<code>-DCMAKE_BUILD_TYPE=Debug</code> to the <code>cmake</code> command.</p>
<p>To run a small suite of unit tests, run <code>make check</code> in the build directory. To
generate this documentation, run <code>make docs</code>. The dependencies for generating
documentation include <code>Doxygen</code>, <code>Sphinx</code>, <code>Breathe</code>, and <code>sphinx_rtd_theme</code>.
The latter 3 are python packages and preferably installed in a python virtual
environment.</p>
<h2 id="running-simulations">Running Simulations</h2>
<p>To run a quick test simulation, checkout the <code>training</code> directory in
<code>problems</code>. It contains several self-contained simple setups that can run
without fiddling with configuration files. For a more in-depth guide on
simulation setup, checkout :doc:<code>Setting up a Simulation &lt;1-setup&gt;</code>.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href=".." class="btn btn-neutral float-left" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../1-setup/" class="btn btn-neutral float-right" title="Quick Setup">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href=".." style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../1-setup/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../javascripts/mathjax.js"></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
